# ğŸ† LZFOF v2.1 â€” Legendary Zero-Friction Optimization Framework

> **The Best Optimization Framework on Earth**

Extract â†’ Generate Variants â†’ Test â†’ Benchmark â†’ Analyze â†’ Apply â†’ Win

---

## ğŸš€ Quick Start

```bash
# Full optimization cycle
npx tsx framework/lzfof.ts cycle scripts/discovery.ts --profile=fastest

# Or step by step:
npx tsx framework/lzfof.ts extract discovery.ts
npx tsx framework/lzfof.ts prompt validateUrl
npx tsx framework/lzfof.ts bench validateUrl --profile=balanced
npx tsx framework/lzfof.ts analyze validateUrl
npx tsx framework/lzfof.ts apply validateUrl
```

---

## âœ¨ v2.1 Features

| Feature | Command | Description |
|---------|---------|-------------|
| ğŸ”„ Full Cycle | `cycle` | Extract â†’ bench â†’ analyze in one command |
| âœ… Auto-Apply | `apply` | Patch winning variant into original file |
| ğŸ§¬ Mutation Tests | `mutate` | Auto-generate edge case test inputs |
| ğŸ§¬ Evolution Mode | `evolve` | N-generation genetic optimization |
| ğŸ“Š Profiles | `--profile=` | fastest, simple, balanced, safe |
| ğŸ“œ Lineage Tracking | `.meta.json` | Track variant origins and patterns |
| ğŸ›¡ï¸ Error-Resistant | Built-in | Timeouts, memory caps, exception filters |
| ğŸ’¡ Confidence Index | Analysis | HIGH/MEDIUM/LOW with reasoning |

---

## ğŸ“‹ Commands

### Core Commands

```bash
# Extract all functions/regex/prompts from a file
npx tsx framework/lzfof.ts extract <file> --type=function

# Generate AI prompt for creating variants
npx tsx framework/lzfof.ts prompt <name>

# Benchmark all variants
npx tsx framework/lzfof.ts bench <name> --profile=fastest

# Analyze and pick winner
npx tsx framework/lzfof.ts analyze <name>
```

### New v2.1 Commands

```bash
# ğŸ”„ Full optimization cycle
npx tsx framework/lzfof.ts cycle <file> --profile=fastest

# âœ… Apply winner to original file
npx tsx framework/lzfof.ts apply <name>

# ğŸ§¬ Generate mutation test cases
npx tsx framework/lzfof.ts mutate <name>

# ğŸ§¬ Run N-generation evolution
npx tsx framework/lzfof.ts evolve <name> --generations=20
```

---

## ğŸ¯ Optimization Profiles

| Profile | Focus | Use When |
|---------|-------|----------|
| `fastest` | Maximum speed | Hot paths, tight loops |
| `simple` | Minimum complexity | Maintainability matters |
| `balanced` | Equal weight | Default, general use |
| `safe` | Maximum correctness | Critical code, prefer original on ties |

```bash
npx tsx framework/lzfof.ts bench <name> --profile=fastest
```

---

## ğŸ“œ Variant Lineage Tracking

Each variant now has a `.meta.json`:

```json
{
  "origin": "v1",
  "agent": "deepseek-r1",
  "prompt": "generated by lzfof.ts prompt(cleanWhitespace)",
  "modifications": [
    "Removed global regex creation",
    "Switched to cached pattern"
  ],
  "timestamp": "2025-12-09T10:44:00Z",
  "generation": 0,
  "score": 0.97,
  "passRate": 1.0
}
```

**Why?** Discover patterns in winning variants â†’ learn what works.

---

## ğŸ§¬ Mutation Testing

Auto-generate edge case tests:

```bash
npx tsx framework/lzfof.ts mutate cleanWhitespace
```

Generates:
- Empty strings, whitespace
- Unicode, emoji, control chars
- Pathological lengths (10,000 chars)
- null, undefined
- XSS-style inputs
- JSON strings, numbers

---

## ğŸ§¬ Evolution Mode

Genetic programming with LLM-assisted mutations:

```bash
npx tsx framework/lzfof.ts evolve addDays --generations=20
```

Each generation:
1. Select elite performers
2. Generate evolution prompt
3. Crossover winning patterns
4. Mutate with novel tricks
5. Re-benchmark
6. Repeat

Eventually finds superhuman implementations.

---

## ğŸ’¡ Confidence Index

Analysis now provides reasoning:

```
ğŸ† WINNER: v2
   Confidence: HIGH
   Reasoning:
     â€¢ Passed all tests
     â€¢ Significantly better (15% higher score)
     â€¢ Zero errors or failures
     â€¢ Sub-millisecond execution
```

---

## ğŸ“ Directory Structure

```
framework/
â”œâ”€â”€ lzfof.ts              # Main CLI v2.1
â”œâ”€â”€ types.ts              # Shared interfaces
â”œâ”€â”€ profiles.ts           # Optimization profiles
â”œâ”€â”€ lineage.ts            # Variant tracking
â”œâ”€â”€ mutator.ts            # Mutation testing
â”œâ”€â”€ patcher.ts            # Code replacement
â”œâ”€â”€ evolver.ts            # Genetic evolution
â”‚
â”œâ”€â”€ extractors/           # Target extraction
â”‚   â”œâ”€â”€ function.ts
â”‚   â”œâ”€â”€ regex.ts
â”‚   â”œâ”€â”€ prompt.ts
â”‚   â”œâ”€â”€ config.ts
â”‚   â””â”€â”€ query.ts
â”‚
â”œâ”€â”€ runners/              # Benchmarking
â”‚   â”œâ”€â”€ function.ts
â”‚   â”œâ”€â”€ regex.ts
â”‚   â””â”€â”€ prompt.ts
â”‚
â””â”€â”€ schema/
    â””â”€â”€ test-case.schema.json

variants/<name>/          # Your variants
â”œâ”€â”€ v0-original.ts
â”œâ”€â”€ v0-original.meta.json # Lineage tracking
â”œâ”€â”€ v1.ts
â”œâ”€â”€ v1.meta.json
â””â”€â”€ ...

tests/<name>.test.json    # Test cases

analysis/                 # Results
â”œâ”€â”€ <name>.json
â”œâ”€â”€ <name>-analysis.json
â””â”€â”€ evolution/

winners/                  # Applied winners
â”œâ”€â”€ <name>.ts
â””â”€â”€ <name>.analysis.json
```

---

## ğŸ”§ Unified JSON Schema

All test cases validate against `schema/test-case.schema.json`:

```json
{
  "cases": [
    { "id": "test-1", "input": ["hello"], "expected": "HELLO" }
  ]
}
```

Supports: function, regex, prompt, config, query test types.

---

## ğŸ“Š Example Results

```
============================================================
ğŸ“Š LZFOF ANALYSIS [function]: getThresholds
   Profile: fastest
============================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Variant          â”‚ Pass %   â”‚ Avg ms   â”‚ Score â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ v2               â”‚     100% â”‚    0.001 â”‚  1.00 â”‚ â­
â”‚ v3               â”‚     100% â”‚    0.002 â”‚  1.00 â”‚
â”‚ v1               â”‚     100% â”‚    0.003 â”‚  1.00 â”‚
â”‚ v4               â”‚     100% â”‚    0.003 â”‚  1.00 â”‚
â”‚ v5               â”‚     100% â”‚    0.003 â”‚  1.00 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ† WINNER: v2
   Confidence: HIGH
```

---

## ğŸ† Philosophy

> "The best code is the code that has been **proven** better."

LZFOF turns optimization from art into science:
1. Generate variants
2. Test exhaustively
3. Let the data decide
4. Apply automatically
5. Track what works

---

## ğŸ“œ License

MIT
